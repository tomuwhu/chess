import{s as qe,n as ue,f as me,r as Je}from"../chunks/scheduler.8b5db029.js";import{S as Ve,i as ze,g as N,s as J,h as R,y as Ye,c as V,j as I,f as M,k as S,a as X,x as O,z as he,m as oe,n as re,A as ae,o as Xe}from"../chunks/index.0c72627f.js";function z(r){return(r==null?void 0:r.length)!==void 0?r:Array.from(r)}var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xe(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ne={exports:{}};(function(r,P){(function(u,E){r.exports=E()})(Ze,function(){return function(u){var E={};function g(o){if(E[o])return E[o].exports;var f=E[o]={i:o,l:!1,exports:{}};return u[o].call(f.exports,f,f.exports,g),f.l=!0,f.exports}return g.m=u,g.c=E,g.d=function(o,f,A){g.o(o,f)||Object.defineProperty(o,f,{enumerable:!0,get:A})},g.r=function(o){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(o,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(o,"__esModule",{value:!0})},g.t=function(o,f){if(1&f&&(o=g(o)),8&f||4&f&&typeof o=="object"&&o&&o.__esModule)return o;var A=Object.create(null);if(g.r(A),Object.defineProperty(A,"default",{enumerable:!0,value:o}),2&f&&typeof o!="string")for(var D in o)g.d(A,D,(function(B){return o[B]}).bind(null,D));return A},g.n=function(o){var f=o&&o.__esModule?function(){return o.default}:function(){return o};return g.d(f,"a",f),f},g.o=function(o,f){return Object.prototype.hasOwnProperty.call(o,f)},g.p="",g(g.s=0)}([function(u,E,g){g.r(E),g.d(E,"Game",function(){return Z}),g.d(E,"moves",function(){return Re}),g.d(E,"status",function(){return We}),g.d(E,"getFen",function(){return Ue}),g.d(E,"move",function(){return Ie}),g.d(E,"aiMove",function(){return Qe});const o=["A","B","C","D","E","F","G","H"],f=["1","2","3","4","5","6","7","8"],A={KING_W:"K",QUEEN_W:"Q",ROOK_W:"R",BISHOP_W:"B",KNIGHT_W:"N",PAWN_W:"P",KING_B:"k",QUEEN_B:"q",ROOK_B:"r",BISHOP_B:"b",KNIGHT_B:"n",PAWN_B:"p"},D="black",B="white",T=[0,1,2,3,4],k={0:1,1:2,2:2,3:3,4:3,5:4},b={0:2,1:2,2:4,3:4,4:5,5:5},v={fullMove:1,halfMove:0,enPassant:null,isFinished:!1,checkMate:!1,check:!1,turn:B},F=Object.assign({pieces:{E1:"K",D1:"Q",A1:"R",H1:"R",C1:"B",F1:"B",B1:"N",G1:"N",A2:"P",B2:"P",C2:"P",D2:"P",E2:"P",F2:"P",G2:"P",H2:"P",E8:"k",D8:"q",A8:"r",H8:"r",C8:"b",F8:"b",B8:"n",G8:"n",A7:"p",B7:"p",C7:"p",D7:"p",E7:"p",F7:"p",G7:"p",H7:"p"},castling:{whiteShort:!0,blackShort:!0,whiteLong:!0,blackLong:!0}},v),d={UP:{A1:"A2",A2:"A3",A3:"A4",A4:"A5",A5:"A6",A6:"A7",A7:"A8",A8:null,B1:"B2",B2:"B3",B3:"B4",B4:"B5",B5:"B6",B6:"B7",B7:"B8",B8:null,C1:"C2",C2:"C3",C3:"C4",C4:"C5",C5:"C6",C6:"C7",C7:"C8",C8:null,D1:"D2",D2:"D3",D3:"D4",D4:"D5",D5:"D6",D6:"D7",D7:"D8",D8:null,E1:"E2",E2:"E3",E3:"E4",E4:"E5",E5:"E6",E6:"E7",E7:"E8",E8:null,F1:"F2",F2:"F3",F3:"F4",F4:"F5",F5:"F6",F6:"F7",F7:"F8",F8:null,G1:"G2",G2:"G3",G3:"G4",G4:"G5",G5:"G6",G6:"G7",G7:"G8",G8:null,H1:"H2",H2:"H3",H3:"H4",H4:"H5",H5:"H6",H6:"H7",H7:"H8",H8:null},DOWN:{A1:null,A2:"A1",A3:"A2",A4:"A3",A5:"A4",A6:"A5",A7:"A6",A8:"A7",B1:null,B2:"B1",B3:"B2",B4:"B3",B5:"B4",B6:"B5",B7:"B6",B8:"B7",C1:null,C2:"C1",C3:"C2",C4:"C3",C5:"C4",C6:"C5",C7:"C6",C8:"C7",D1:null,D2:"D1",D3:"D2",D4:"D3",D5:"D4",D6:"D5",D7:"D6",D8:"D7",E1:null,E2:"E1",E3:"E2",E4:"E3",E5:"E4",E6:"E5",E7:"E6",E8:"E7",F1:null,F2:"F1",F3:"F2",F4:"F3",F5:"F4",F6:"F5",F7:"F6",F8:"F7",G1:null,G2:"G1",G3:"G2",G4:"G3",G5:"G4",G6:"G5",G7:"G6",G8:"G7",H1:null,H2:"H1",H3:"H2",H4:"H3",H5:"H4",H6:"H5",H7:"H6",H8:"H7"},LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:"A1",B2:"A2",B3:"A3",B4:"A4",B5:"A5",B6:"A6",B7:"A7",B8:"A8",C1:"B1",C2:"B2",C3:"B3",C4:"B4",C5:"B5",C6:"B6",C7:"B7",C8:"B8",D1:"C1",D2:"C2",D3:"C3",D4:"C4",D5:"C5",D6:"C6",D7:"C7",D8:"C8",E1:"D1",E2:"D2",E3:"D3",E4:"D4",E5:"D5",E6:"D6",E7:"D7",E8:"D8",F1:"E1",F2:"E2",F3:"E3",F4:"E4",F5:"E5",F6:"E6",F7:"E7",F8:"E8",G1:"F1",G2:"F2",G3:"F3",G4:"F4",G5:"F5",G6:"F6",G7:"F7",G8:"F8",H1:"G1",H2:"G2",H3:"G3",H4:"G4",H5:"G5",H6:"G6",H7:"G7",H8:"G8"},RIGHT:{A1:"B1",A2:"B2",A3:"B3",A4:"B4",A5:"B5",A6:"B6",A7:"B7",A8:"B8",B1:"C1",B2:"C2",B3:"C3",B4:"C4",B5:"C5",B6:"C6",B7:"C7",B8:"C8",C1:"D1",C2:"D2",C3:"D3",C4:"D4",C5:"D5",C6:"D6",C7:"D7",C8:"D8",D1:"E1",D2:"E2",D3:"E3",D4:"E4",D5:"E5",D6:"E6",D7:"E7",D8:"E8",E1:"F1",E2:"F2",E3:"F3",E4:"F4",E5:"F5",E6:"F6",E7:"F7",E8:"F8",F1:"G1",F2:"G2",F3:"G3",F4:"G4",F5:"G5",F6:"G6",F7:"G7",F8:"G8",G1:"H1",G2:"H2",G3:"H3",G4:"H4",G5:"H5",G6:"H6",G7:"H7",G8:"H8",H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},UP_LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:"A2",B2:"A3",B3:"A4",B4:"A5",B5:"A6",B6:"A7",B7:"A8",B8:null,C1:"B2",C2:"B3",C3:"B4",C4:"B5",C5:"B6",C6:"B7",C7:"B8",C8:null,D1:"C2",D2:"C3",D3:"C4",D4:"C5",D5:"C6",D6:"C7",D7:"C8",D8:null,E1:"D2",E2:"D3",E3:"D4",E4:"D5",E5:"D6",E6:"D7",E7:"D8",E8:null,F1:"E2",F2:"E3",F3:"E4",F4:"E5",F5:"E6",F6:"E7",F7:"E8",F8:null,G1:"F2",G2:"F3",G3:"F4",G4:"F5",G5:"F6",G6:"F7",G7:"F8",G8:null,H1:"G2",H2:"G3",H3:"G4",H4:"G5",H5:"G6",H6:"G7",H7:"G8",H8:null},DOWN_RIGHT:{A1:null,A2:"B1",A3:"B2",A4:"B3",A5:"B4",A6:"B5",A7:"B6",A8:"B7",B1:null,B2:"C1",B3:"C2",B4:"C3",B5:"C4",B6:"C5",B7:"C6",B8:"C7",C1:null,C2:"D1",C3:"D2",C4:"D3",C5:"D4",C6:"D5",C7:"D6",C8:"D7",D1:null,D2:"E1",D3:"E2",D4:"E3",D5:"E4",D6:"E5",D7:"E6",D8:"E7",E1:null,E2:"F1",E3:"F2",E4:"F3",E5:"F4",E6:"F5",E7:"F6",E8:"F7",F1:null,F2:"G1",F3:"G2",F4:"G3",F5:"G4",F6:"G5",F7:"G6",F8:"G7",G1:null,G2:"H1",G3:"H2",G4:"H3",G5:"H4",G6:"H5",G7:"H6",G8:"H7",H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},UP_RIGHT:{A1:"B2",A2:"B3",A3:"B4",A4:"B5",A5:"B6",A6:"B7",A7:"B8",A8:null,B1:"C2",B2:"C3",B3:"C4",B4:"C5",B5:"C6",B6:"C7",B7:"C8",B8:null,C1:"D2",C2:"D3",C3:"D4",C4:"D5",C5:"D6",C6:"D7",C7:"D8",C8:null,D1:"E2",D2:"E3",D3:"E4",D4:"E5",D5:"E6",D6:"E7",D7:"E8",D8:null,E1:"F2",E2:"F3",E3:"F4",E4:"F5",E5:"F6",E6:"F7",E7:"F8",E8:null,F1:"G2",F2:"G3",F3:"G4",F4:"G5",F5:"G6",F6:"G7",F7:"G8",F8:null,G1:"H2",G2:"H3",G3:"H4",G4:"H5",G5:"H6",G6:"H7",G7:"H8",G8:null,H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},DOWN_LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:null,B2:"A1",B3:"A2",B4:"A3",B5:"A4",B6:"A5",B7:"A6",B8:"A7",C1:null,C2:"B1",C3:"B2",C4:"B3",C5:"B4",C6:"B5",C7:"B6",C8:"B7",D1:null,D2:"C1",D3:"C2",D4:"C3",D5:"C4",D6:"C5",D7:"C6",D8:"C7",E1:null,E2:"D1",E3:"D2",E4:"D3",E5:"D4",E6:"D5",E7:"D6",E8:"D7",F1:null,F2:"E1",F3:"E2",F4:"E3",F5:"E4",F6:"E5",F7:"E6",F8:"E7",G1:null,G2:"F1",G3:"F2",G4:"F3",G5:"F4",G6:"F5",G7:"F6",G8:"F7",H1:null,H2:"G1",H3:"G2",H4:"G3",H5:"G4",H6:"G5",H7:"G6",H8:"G7"}},w=[[0,0,0,0,0,0,0,0],[5,5,5,5,5,5,5,5],[1,1,2,3,3,2,1,1],[.5,.5,1,2.5,2.5,1,.5,.5],[0,0,0,2,2,0,0,0],[.5,0,1,0,0,1,0,.5],[.5,0,0,-2,-2,0,0,.5],[0,0,0,0,0,0,0,0]],j=[[-4,-3,-2,-2,-2,-2,-3,-4],[-3,-2,0,0,0,0,-2,-3],[-2,0,1,1.5,1.5,1,0,-2],[-2,.5,1.5,2,2,1.5,.5,-2],[-2,0,1.5,2,2,1.5,0,-2],[-2,.5,1,1.5,1.5,1,.5,-2],[-3,-2,0,.5,.5,0,-2,-3],[-4,-3,-2,-2,-2,-2,-3,-4]],H=[[-2,-1,-1,-1,-1,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,1,1,.5,0,-1],[-1,.5,.5,1,1,.5,.5,-1],[-1,0,1,1,1,1,0,-1],[-1,1,1,1,1,1,1,-1],[-1,.5,0,0,0,0,.5,-1],[-2,-1,-1,-1,-1,-1,-1,-2]],W=[[0,0,0,0,0,0,0,0],[.5,1,1,1,1,1,1,.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[0,0,0,.5,.5,0,0,0]],_=[[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-2,-3,-3,-4,-4,-3,-3,-2],[-1,-2,-2,-2,-2,-2,-2,-1],[2,2,0,0,0,0,2,2],[2,3,1,0,0,1,3,2]],U=[[-2,-1,-1,-.5,-.5,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,.5,.5,.5,0,-1],[-.5,0,.5,.5,.5,.5,0,-.5],[0,0,.5,.5,.5,.5,0,-.5],[-1,.5,.5,.5,.5,.5,0,-1],[-1,0,.5,0,0,0,0,-1],[-2,-1,-1,-.5,-.5,-1,-1,-2]],m={P:w.slice().reverse(),p:w,N:j.slice().reverse(),n:j,B:H.slice().reverse(),b:H,R:W.slice().reverse(),r:W,K:_.slice().reverse(),k:_,Q:U.slice().reverse(),q:U};function p(h){return d.UP[h]}function G(h){return d.DOWN[h]}function a(h){return d.LEFT[h]}function y(h){return d.RIGHT[h]}function K(h){return d.UP_LEFT[h]}function $(h){return d.UP_RIGHT[h]}function ee(h){return d.DOWN_LEFT[h]}function te(h){return d.DOWN_RIGHT[h]}function Ee(h){const t=K(h);return t?p(t):null}function de(h){const t=K(h);return t?a(t):null}function Be(h){const t=$(h);return t?p(t):null}function De(h){const t=$(h);return t?y(t):null}function Fe(h){const t=ee(h);return t?G(t):null}function be(h){const t=ee(h);return t?a(t):null}function ve(h){const t=te(h);return t?G(t):null}function Ge(h){const t=te(h);return t?y(t):null}function Ae(h,t){return t===B?d.UP[h]:d.DOWN[h]}function fe(h,t){return t===B?d.UP_LEFT[h]:d.DOWN_RIGHT[h]}function Ce(h,t){return t===B?d.UP_RIGHT[h]:d.DOWN_LEFT[h]}function He(h,t){return t===B?d.DOWN_LEFT[h]:d.UP_RIGHT[h]}function ke(h,t){return t===B?d.DOWN_RIGHT[h]:d.UP_LEFT[h]}function ie(h){return{k:10,q:9,r:5,b:3,n:3,p:1}[h.toLowerCase()]||0}function le(h){return typeof h=="string"&&h.match("^[a-hA-H]{1}[1-8]{1}$")}const Pe=-1e3,pe=1e3;class ce{constructor(t=JSON.parse(JSON.stringify(F))){if(typeof t=="object")this.configuration=Object.assign({},v,t);else{if(typeof t!="string")throw new Error(`Unknown configuration type ${typeof config}.`);this.configuration=Object.assign({},v,function(i=""){const[n,s,e,c,C,l]=i.split(" "),L={pieces:Object.fromEntries(n.split("/").flatMap((Q,ne)=>{let q=0;return Q.split("").reduce((se,x)=>{const we=x.match(/k|b|q|n|p|r/i);we&&(se.push([`${o[q]}${f[7-ne]}`,we[0]]),q+=1);const _e=x.match(/[1-8]/);return _e&&(q+=Number(_e)),se},[])}))};return L.turn=s==="b"?D:B,L.castling={whiteLong:!1,whiteShort:!1,blackLong:!1,blackShort:!1},e.includes("K")&&(L.castling.whiteShort=!0),e.includes("k")&&(L.castling.blackShort=!0),e.includes("Q")&&(L.castling.whiteLong=!0),e.includes("q")&&(L.castling.blackLong=!0),le(c)&&(L.enPassant=c.toUpperCase()),L.halfMove=parseInt(C),L.fullMove=parseInt(l),L}(t))}this.configuration.castling||(this.configuration.castling={whiteShort:!0,blackShort:!0,whiteLong:!0,blackLong:!0}),this.history=[]}getAttackingFields(t=this.getPlayingColor()){let i=[];for(const n in this.configuration.pieces){const s=this.getPiece(n);this.getPieceColor(s)===t&&(i=[...i,...this.getPieceMoves(s,n)])}return i}isAttackingKing(t=this.getPlayingColor()){let i=null;for(const n in this.configuration.pieces){const s=this.getPiece(n);if(this.isKing(s)&&this.getPieceColor(s)!==t){i=n;break}}return this.isPieceUnderAttack(i)}isPieceUnderAttack(t){const i=this.getPieceOnLocationColor(t),n=this.getEnemyColor(i);let s=!1,e=t,c=0;for(;p(e)&&!s;){e=p(e),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isRook(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}for(e=t,c=0;G(e)&&!s;){e=G(e),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isRook(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}for(e=t,c=0;a(e)&&!s;){e=a(e),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isRook(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}for(e=t,c=0;y(e)&&!s;){e=y(e),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isRook(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}for(e=t,c=0;Ce(e,i)&&!s;){e=Ce(e,i),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isBishop(l)||this.isQueen(l)||c===1&&(this.isKing(l)||this.isPawn(l)))&&(s=!0),l)break}for(e=t,c=0;fe(e,i)&&!s;){e=fe(e,i),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isBishop(l)||this.isQueen(l)||c===1&&(this.isKing(l)||this.isPawn(l)))&&(s=!0),l)break}for(e=t,c=0;ke(e,i)&&!s;){e=ke(e,i),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isBishop(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}for(e=t,c=0;He(e,i)&&!s;){e=He(e,i),c++;const l=this.getPiece(e);if(l&&this.getPieceColor(l)===n&&(this.isBishop(l)||this.isQueen(l)||this.isKing(l)&&c===1)&&(s=!0),l)break}e=Be(t);let C=this.getPiece(e);return C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=De(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=de(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=Ee(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=Fe(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=be(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=ve(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),e=Ge(t),C=this.getPiece(e),C&&this.getPieceColor(C)===n&&this.isKnight(C)&&(s=!0),s}hasPlayingPlayerCheck(){return this.isAttackingKing(this.getNonPlayingColor())}hasNonPlayingPlayerCheck(){return this.isAttackingKing(this.getPlayingColor())}getLowestValuePieceAttackingLocation(t,i=this.getPlayingColor()){let n=null;for(const s in this.configuration.pieces){const e=this.getPiece(s);this.getPieceColor(e)===i&&this.getPieceMoves(e,s).map(c=>{c===t&&(n===null||ie(e)<n)&&(n=ie(e))})}return n}getMoves(t=this.getPlayingColor(),i=null){const n={};let s=0;for(const C in this.configuration.pieces){const l=this.getPiece(C);if(this.getPieceColor(l)===t){const L=this.getPieceMoves(l,C);L.length&&s++,Object.assign(n,{[C]:L})}}const e=this.getAttackingFields(this.getNonPlayingColor());if(this.isLeftCastlingPossible(e)&&(this.isPlayingWhite()&&n.E1.push("C1"),this.isPlayingBlack()&&n.E8.push("C8")),this.isRightCastlingPossible(e)&&(this.isPlayingWhite()&&n.E1.push("G1"),this.isPlayingBlack()&&n.E8.push("G8")),i&&s>i)return n;const c={};for(const C in n)n[C].map(l=>{const L={pieces:Object.assign({},this.configuration.pieces),castling:Object.assign({},this.configuration.castling)},Q=new ce(L);Q.move(C,l),(this.isPlayingWhite()&&!Q.isAttackingKing(D)||this.isPlayingBlack()&&!Q.isAttackingKing(B))&&(c[C]||(c[C]=[]),c[C].push(l))});return Object.keys(c).length||(this.configuration.isFinished=!0,this.hasPlayingPlayerCheck()&&(this.configuration.checkMate=!0)),c}isLeftCastlingPossible(t){if(this.isPlayingWhite()&&!this.configuration.castling.whiteLong||this.isPlayingBlack()&&!this.configuration.castling.blackLong)return!1;let i=null;if(this.isPlayingWhite()&&this.getPiece("E1")==="K"&&this.getPiece("A1")==="R"&&!t.includes("E1")?i="E1":this.isPlayingBlack()&&this.getPiece("E8")==="k"&&this.getPiece("A8")==="r"&&!t.includes("E8")&&(i="E8"),!i)return!1;let n=a(i);return!this.getPiece(n)&&!t.includes(n)&&(n=a(n),!this.getPiece(n)&&!t.includes(n)&&(n=a(n),!this.getPiece(n)))}isRightCastlingPossible(t){if(this.isPlayingWhite()&&!this.configuration.castling.whiteShort||this.isPlayingBlack()&&!this.configuration.castling.blackShort)return!1;let i=null;if(this.isPlayingWhite()&&this.getPiece("E1")==="K"&&this.getPiece("H1")==="R"&&!t.includes("E1")?i="E1":this.isPlayingBlack()&&this.getPiece("E8")==="k"&&this.getPiece("H8")==="r"&&!t.includes("E8")&&(i="E8"),!i)return!1;let n=y(i);return!this.getPiece(n)&&!t.includes(n)&&(n=y(n),!this.getPiece(n)&&!t.includes(n))}getPieceMoves(t,i){return this.isPawn(t)?this.getPawnMoves(t,i):this.isKnight(t)?this.getKnightMoves(t,i):this.isRook(t)?this.getRookMoves(t,i):this.isBishop(t)?this.getBishopMoves(t,i):this.isQueen(t)?this.getQueenMoves(t,i):this.isKing(t)?this.getKingMoves(t,i):[]}isPawn(t){return t.toUpperCase()==="P"}isKnight(t){return t.toUpperCase()==="N"}isRook(t){return t.toUpperCase()==="R"}isBishop(t){return t.toUpperCase()==="B"}isQueen(t){return t.toUpperCase()==="Q"}isKing(t){return t.toUpperCase()==="K"}getPawnMoves(t,i){const n=[],s=this.getPieceColor(t);let e=Ae(i,s);return e&&!this.getPiece(e)&&(n.push(e),e=Ae(e,s),function(c,C){return c===B&&C[1]==="2"||c===D&&C[1]==="7"}(s,i)&&e&&!this.getPiece(e)&&n.push(e)),e=fe(i,s),e&&(this.getPiece(e)&&this.getPieceOnLocationColor(e)!==s||e===this.configuration.enPassant)&&n.push(e),e=Ce(i,s),e&&(this.getPiece(e)&&this.getPieceOnLocationColor(e)!==s||e===this.configuration.enPassant)&&n.push(e),n}getKnightMoves(t,i){const n=[],s=this.getPieceColor(t);let e=Be(i);return e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=De(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=Ee(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=de(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=be(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=Fe(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=Ge(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=ve(i),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),n}getRookMoves(t,i){const n=[],s=this.getPieceColor(t);let e=i;for(;p(e);){e=p(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;G(e);){e=G(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;y(e);){e=y(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;a(e);){e=a(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}return n}getBishopMoves(t,i){const n=[],s=this.getPieceColor(t);let e=i;for(;K(e);){e=K(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;$(e);){e=$(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;ee(e);){e=ee(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}for(e=i;te(e);){e=te(e);const c=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==s&&n.push(e),c)break}return n}getQueenMoves(t,i){return[...this.getRookMoves(t,i),...this.getBishopMoves(t,i)]}getKingMoves(t,i){const n=[],s=this.getPieceColor(t);let e=i;return e=p(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=y(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=G(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=a(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=K(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=$(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=ee(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),e=i,e=te(e),e&&this.getPieceOnLocationColor(e)!==s&&n.push(e),n}getPieceColor(t){return t.toUpperCase()===t?B:D}getPieceOnLocationColor(t){const i=this.getPiece(t);return i?i.toUpperCase()===i?B:D:null}getPiece(t){return this.configuration.pieces[t]}setPiece(t,i){if(!function(n){return Object.values(A).includes(n)}(i))throw new Error("Invalid piece "+i);if(!le(t))throw new Error("Invalid location "+t);this.configuration.pieces[t.toUpperCase()]=i}removePiece(t){if(!le(t))throw new Error("Invalid location "+t);delete this.configuration.pieces[t.toUpperCase()]}isEmpty(t){if(!le(t))throw new Error("Invalid location "+t);return!this.configuration.pieces[t.toUpperCase()]}getEnemyColor(t){return t===B?D:B}getPlayingColor(){return this.configuration.turn}getNonPlayingColor(){return this.isPlayingWhite()?D:B}isPlayingWhite(){return this.configuration.turn===B}isPlayingBlack(){return this.configuration.turn===D}addMoveToHistory(t,i){this.history.push({from:t,to:i,configuration:JSON.parse(JSON.stringify(this.configuration))})}move(t,i){const n=this.getPiece(t),s=this.getPiece(i);if(!n)throw new Error("There is no piece at "+t);var e,c;if(Object.assign(this.configuration.pieces,{[i]:n}),delete this.configuration.pieces[t],this.isPlayingWhite()&&this.isPawn(n)&&i[1]==="8"&&Object.assign(this.configuration.pieces,{[i]:"Q"}),this.isPlayingBlack()&&this.isPawn(n)&&i[1]==="1"&&Object.assign(this.configuration.pieces,{[i]:"q"}),this.isPawn(n)&&i===this.configuration.enPassant&&delete this.configuration.pieces[e=i,c=this.getPlayingColor(),c===B?d.DOWN[e]:d.UP[e]],this.isPawn(n)&&this.isPlayingWhite()&&t[1]==="2"&&i[1]==="4"?this.configuration.enPassant=t[0]+"3":this.isPawn(n)&&this.isPlayingBlack()&&t[1]==="7"&&i[1]==="5"?this.configuration.enPassant=t[0]+"6":this.configuration.enPassant=null,t==="E1"&&Object.assign(this.configuration.castling,{whiteLong:!1,whiteShort:!1}),t==="E8"&&Object.assign(this.configuration.castling,{blackLong:!1,blackShort:!1}),t==="A1"&&Object.assign(this.configuration.castling,{whiteLong:!1}),t==="H1"&&Object.assign(this.configuration.castling,{whiteShort:!1}),t==="A8"&&Object.assign(this.configuration.castling,{blackLong:!1}),t==="H8"&&Object.assign(this.configuration.castling,{blackShort:!1}),this.isKing(n)){if(t==="E1"&&i==="C1")return this.move("A1","D1");if(t==="E8"&&i==="C8")return this.move("A8","D8");if(t==="E1"&&i==="G1")return this.move("H1","F1");if(t==="E8"&&i==="G8")return this.move("H8","F8")}this.configuration.turn=this.isPlayingWhite()?D:B,this.isPlayingWhite()&&this.configuration.fullMove++,this.configuration.halfMove++,(s||this.isPawn(n))&&(this.configuration.halfMove=0)}exportJson(){return{moves:this.getMoves(),pieces:this.configuration.pieces,turn:this.configuration.turn,isFinished:this.configuration.isFinished,check:this.hasPlayingPlayerCheck(),checkMate:this.configuration.checkMate,castling:this.configuration.castling,enPassant:this.configuration.enPassant,halfMove:this.configuration.halfMove,fullMove:this.configuration.fullMove}}calculateAiMove(t){return this.calculateAiMoves(t)[0]}calculateAiMoves(t){if(t=parseInt(t),!T.includes(t))throw new Error(`Invalid level ${t}. You can choose ${T.join(",")}`);this.shouldIncreaseLevel()&&t++;const i=[],n=this.calculateScore(this.getPlayingColor()),s=this.getMoves();for(const e in s)s[e].map(c=>{const C=this.getTestBoard(),l=!!C.getPiece(c);C.move(e,c),i.push({from:e,to:c,score:C.testMoveScores(this.getPlayingColor(),t,l,l?C.calculateScore(this.getPlayingColor()):n,c).score+C.calculateScoreByPiecesLocation(this.getPlayingColor())+Math.floor(Math.random()*(this.configuration.halfMove>10?this.configuration.halfMove-10:1)*10)/10})});return i.sort((e,c)=>e.score<c.score?1:e.score>c.score?-1:0),i}shouldIncreaseLevel(){return this.getIngamePiecesValue()<50}getIngamePiecesValue(){let t=0;for(const i in this.configuration.pieces)t+=ie(this.getPiece(i));return t}getTestBoard(){const t={pieces:Object.assign({},this.configuration.pieces),castling:Object.assign({},this.configuration.castling),turn:this.configuration.turn,enPassant:this.configuration.enPassant};return new ce(t)}testMoveScores(t,i,n,s,e,c=1){let C=null;if(c<b[i]&&this.hasPlayingPlayerCheck()?C=this.getMoves(this.getPlayingColor()):(c<k[i]||n&&c<b[i])&&(C=this.getMoves(this.getPlayingColor(),5)),this.configuration.isFinished)return{score:this.calculateScore(t)+(this.getPlayingColor()===t?c:-c),max:!0};if(!C)return s!==null?{score:s,max:!1}:{score:this.calculateScore(t),max:!1};let l=this.getPlayingColor()===t?Pe:pe,L=!1;for(const Q in C)L||C[Q].map(ne=>{if(L)return;const q=this.getTestBoard(),se=!!q.getPiece(ne);if(q.move(Q,ne),q.hasNonPlayingPlayerCheck())return;const x=q.testMoveScores(t,i,se,se?q.calculateScore(t):s,ne,c+1);x.max&&(L=!0),l=this.getPlayingColor()===t?Math.max(l,x.score):Math.min(l,x.score)});return{score:l,max:!1}}calculateScoreByPiecesLocation(t=this.getPlayingColor()){const i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7};let n=0;for(const s in this.configuration.pieces){const e=this.getPiece(s);if(m[e]){const c=m[e][s[1]-1][i[s[0]]];n+=.5*(this.getPieceColor(e)===t?c:-c)}}return n}calculateScore(t=this.getPlayingColor()){let i=0;if(this.configuration.checkMate)return this.getPlayingColor()===t?Pe:pe;if(this.configuration.isFinished)return this.getPlayingColor()===t?pe:Pe;for(const n in this.configuration.pieces){const s=this.getPiece(n);this.getPieceColor(s)===t?i+=10*ie(s):i-=10*ie(s)}return i}}class Z{constructor(t){this.board=new ce(t)}move(t,i){t=t.toUpperCase(),i=i.toUpperCase();const n=this.board.getMoves();if(!n[t]||!n[t].includes(i))throw new Error(`Invalid move from ${t} to ${i} for ${this.board.getPlayingColor()}`);return this.board.addMoveToHistory(t,i),this.board.move(t,i),{[t]:i}}moves(t=null){return(t?this.board.getMoves()[t.toUpperCase()]:this.board.getMoves())||[]}setPiece(t,i){this.board.setPiece(t,i)}removePiece(t){this.board.removePiece(t)}aiMove(t=2){const i=this.board.calculateAiMove(t);return this.move(i.from,i.to)}getHistory(t=!1){return t?this.board.history.reverse():this.board.history}printToConsole(){(function(t){process.stdout.write(`
`);let i=B;Object.assign([],f).reverse().map(n=>{process.stdout.write(""+n),o.map(s=>{switch(t.pieces[`${s}${n}`]){case"K":process.stdout.write("♚");break;case"Q":process.stdout.write("♛");break;case"R":process.stdout.write("♜");break;case"B":process.stdout.write("♝");break;case"N":process.stdout.write("♞");break;case"P":process.stdout.write("♟");break;case"k":process.stdout.write("♔");break;case"q":process.stdout.write("♕");break;case"r":process.stdout.write("♖");break;case"b":process.stdout.write("♗");break;case"n":process.stdout.write("♘");break;case"p":process.stdout.write("♙");break;default:process.stdout.write(i===B?"█":"░")}i=i===B?D:B}),i=i===B?D:B,process.stdout.write(`
`)}),process.stdout.write(" "),o.map(n=>{process.stdout.write(""+n)}),process.stdout.write(`
`)})(this.board.configuration)}exportJson(){return this.board.exportJson()}exportFEN(){return function(t){let i="";Object.assign([],f).reverse().map(C=>{let l=0;C<8&&(i+="/"),o.map(L=>{const Q=t.pieces[`${L}${C}`];Q?(l&&(i+=l.toString(),l=0),i+=Q):l++}),i+=""+(l||"")}),i+=t.turn===B?" w ":" b ";const{whiteShort:n,whiteLong:s,blackLong:e,blackShort:c}=t.castling;return s||n||e||c?(n&&(i+="K"),s&&(i+="Q"),c&&(i+="k"),e&&(i+="q")):i+="-",i+=" "+(t.enPassant?t.enPassant.toLowerCase():"-"),i+=" "+t.halfMove,i+=" "+t.fullMove,i}(this.board.configuration)}}function Re(h){if(!h)throw new Error("Configuration param required.");return new Z(h).moves()}function We(h){if(!h)throw new Error("Configuration param required.");return new Z(h).exportJson()}function Ue(h){if(!h)throw new Error("Configuration param required.");return new Z(h).exportFEN()}function Ie(h,t,i){if(!h)throw new Error("Configuration param required.");const n=new Z(h);return n.move(t,i),typeof h=="object"?n.exportJson():n.exportFEN()}function Qe(h,t=2){if(!h)throw new Error("Configuration param required.");const i=new Z(h).board.calculateAiMove(t);return{[i.from]:i.to}}}])})})(Ne);var $e=Ne.exports;const et=xe($e);function ye(r,P,u){const E=r.slice();return E[12]=P[u],E}function Oe(r,P,u){const E=r.slice();return E[15]=P[u],E[17]=u,E}function Le(r,P,u){const E=r.slice();return E[12]=P[u],E[19]=u,E}function Me(r,P,u){const E=r.slice();return E[12]=P[u],E}function je(r){let P,u=r[12]+"",E;return{c(){P=N("td"),E=oe(u),this.h()},l(g){P=R(g,"TD",{class:!0});var o=I(P);E=re(o,u),o.forEach(M),this.h()},h(){S(P,"class","s svelte-74krj5")},m(g,o){X(g,P,o),O(P,E)},p:ue,d(g){g&&M(P)}}}function Te(r){let P,u,E=r[1][r[17]][r[19]]+"",g,o,f,A,D,B;function T(){return r[6](r[17],r[19],r[15],r[12])}function k(...v){return r[8](r[12],r[15],...v)}function b(){return r[9](r[17],r[19],r[15],r[12])}return{c(){P=N("td"),u=N("span"),g=oe(E),this.h()},l(v){P=R(v,"TD",{class:!0});var F=I(P);u=R(F,"SPAN",{class:!0,draggable:!0});var d=I(u);g=re(d,E),d.forEach(M),F.forEach(M),this.h()},h(){S(u,"class",o=me(r[2][r[17]][r[19]])+" svelte-74krj5"),S(u,"draggable",f=!r[0]&&r[2][r[17]][r[19]]=="w"),S(P,"class",A="s"+(r[17]+r[19])%2+" "+(!r[0]&&r[3].includes(r[12]+r[15])?"x":"")+" svelte-74krj5")},m(v,F){X(v,P,F),O(P,u),O(u,g),D||(B=[ae(u,"dragstart",T),ae(u,"dragend",r[7]),ae(P,"dragover",k),ae(P,"drop",b)],D=!0)},p(v,F){r=v,F&2&&E!==(E=r[1][r[17]][r[19]]+"")&&Xe(g,E),F&4&&o!==(o=me(r[2][r[17]][r[19]])+" svelte-74krj5")&&S(u,"class",o),F&5&&f!==(f=!r[0]&&r[2][r[17]][r[19]]=="w")&&S(u,"draggable",f),F&9&&A!==(A="s"+(r[17]+r[19])%2+" "+(!r[0]&&r[3].includes(r[12]+r[15])?"x":"")+" svelte-74krj5")&&S(P,"class",A)},d(v){v&&M(P),D=!1,Je(B)}}}function Ke(r){let P,u,E=8-r[17]+"",g,o,f,A,D=8-r[17]+"",B,T=z(Y),k=[];for(let b=0;b<T.length;b+=1)k[b]=Te(Le(r,T,b));return{c(){P=N("tr"),u=N("td"),g=oe(E),o=J();for(let b=0;b<k.length;b+=1)k[b].c();f=J(),A=N("td"),B=oe(D),this.h()},l(b){P=R(b,"TR",{});var v=I(P);u=R(v,"TD",{class:!0});var F=I(u);g=re(F,E),F.forEach(M),o=V(v);for(let w=0;w<k.length;w+=1)k[w].l(v);f=V(v),A=R(v,"TD",{class:!0});var d=I(A);B=re(d,D),d.forEach(M),v.forEach(M),this.h()},h(){S(u,"class","o svelte-74krj5"),S(A,"class","o svelte-74krj5")},m(b,v){X(b,P,v),O(P,u),O(u,g),O(P,o);for(let F=0;F<k.length;F+=1)k[F]&&k[F].m(P,null);O(P,f),O(P,A),O(A,B)},p(b,v){if(v&63){T=z(Y);let F;for(F=0;F<T.length;F+=1){const d=Le(b,T,F);k[F]?k[F].p(d,v):(k[F]=Te(d),k[F].c(),k[F].m(P,f))}for(;F<k.length;F+=1)k[F].d(1);k.length=T.length}},d(b){b&&M(P),he(k,b)}}}function Se(r){let P,u=r[12]+"",E;return{c(){P=N("td"),E=oe(u),this.h()},l(g){P=R(g,"TD",{class:!0});var o=I(P);E=re(o,u),o.forEach(M),this.h()},h(){S(P,"class","s svelte-74krj5")},m(g,o){X(g,P,o),O(P,E)},p:ue,d(g){g&&M(P)}}}function tt(r){let P,u="Sakk",E,g,o,f,A,D,B,T,k,b,v,F,d,w,j=z(Y),H=[];for(let p=0;p<j.length;p+=1)H[p]=je(Me(r,j,p));let W=z(ge),_=[];for(let p=0;p<W.length;p+=1)_[p]=Ke(Oe(r,W,p));let U=z(Y),m=[];for(let p=0;p<U.length;p+=1)m[p]=Se(ye(r,U,p));return{c(){P=N("h1"),P.textContent=u,E=J(),g=N("table"),o=N("tr"),f=N("td"),A=J();for(let p=0;p<H.length;p+=1)H[p].c();D=J(),B=N("td"),T=J();for(let p=0;p<_.length;p+=1)_[p].c();k=J(),b=N("tr"),v=N("td"),F=J();for(let p=0;p<m.length;p+=1)m[p].c();d=J(),w=N("td"),this.h()},l(p){P=R(p,"H1",{class:!0,"data-svelte-h":!0}),Ye(P)!=="svelte-masb5y"&&(P.textContent=u),E=V(p),g=R(p,"TABLE",{class:!0});var G=I(g);o=R(G,"TR",{});var a=I(o);f=R(a,"TD",{class:!0}),I(f).forEach(M),A=V(a);for(let K=0;K<H.length;K+=1)H[K].l(a);D=V(a),B=R(a,"TD",{class:!0}),I(B).forEach(M),a.forEach(M),T=V(G);for(let K=0;K<_.length;K+=1)_[K].l(G);k=V(G),b=R(G,"TR",{});var y=I(b);v=R(y,"TD",{class:!0}),I(v).forEach(M),F=V(y);for(let K=0;K<m.length;K+=1)m[K].l(y);d=V(y),w=R(y,"TD",{class:!0}),I(w).forEach(M),y.forEach(M),G.forEach(M),this.h()},h(){S(P,"class","svelte-74krj5"),S(f,"class","c svelte-74krj5"),S(B,"class","c svelte-74krj5"),S(v,"class","c svelte-74krj5"),S(w,"class","c svelte-74krj5"),S(g,"class","svelte-74krj5")},m(p,G){X(p,P,G),X(p,E,G),X(p,g,G),O(g,o),O(o,f),O(o,A);for(let a=0;a<H.length;a+=1)H[a]&&H[a].m(o,null);O(o,D),O(o,B),O(g,T);for(let a=0;a<_.length;a+=1)_[a]&&_[a].m(g,null);O(g,k),O(g,b),O(b,v),O(b,F);for(let a=0;a<m.length;a+=1)m[a]&&m[a].m(b,null);O(b,d),O(b,w)},p(p,[G]){if(G&0){j=z(Y);let a;for(a=0;a<j.length;a+=1){const y=Me(p,j,a);H[a]?H[a].p(y,G):(H[a]=je(y),H[a].c(),H[a].m(o,D))}for(;a<H.length;a+=1)H[a].d(1);H.length=j.length}if(G&63){W=z(ge);let a;for(a=0;a<W.length;a+=1){const y=Oe(p,W,a);_[a]?_[a].p(y,G):(_[a]=Ke(y),_[a].c(),_[a].m(g,k))}for(;a<_.length;a+=1)_[a].d(1);_.length=W.length}if(G&0){U=z(Y);let a;for(a=0;a<U.length;a+=1){const y=ye(p,U,a);m[a]?m[a].p(y,G):(m[a]=Se(y),m[a].c(),m[a].m(b,d))}for(;a<m.length;a+=1)m[a].d(1);m.length=U.length}},i:ue,o:ue,d(p){p&&(M(P),M(E),M(g)),he(H,p),he(_,p),he(m,p)}}}const Y="ABCDEFGH",ge="87654321";function it(r,P,u){const E=new et.Game;var g=!1,o=["♜♞♝♛♚♝♞♜","♟♟♟♟♟♟♟♟♟","        ","        ","        ","        ","♟♟♟♟♟♟♟♟♟","♜♞♝♛♚♝♞♜"].map(d=>d.split("")),f=["bbbbbbbb","bbbbbbbb","nnnnnnnn","nnnnnnnn","nnnnnnnn","nnnnnnnn","wwwwwwww","wwwwwwww"].map(d=>d.split("")),A=[],D=["",0,0];const B=(d,w,j,H)=>{D=[H+j,d,w],u(3,A=E.moves(D[0]))},T=(d,w,j,H)=>{var W=[o[D[1]][D[2]],f[D[1]][D[2]]];o[d][w],f[d][w],u(1,o[D[1]][D[2]]=" ",o),u(2,f[D[1]][D[2]]="n",f),u(1,o[d][w]=W[0],o),u(2,f[d][w]=W[1],f),W[0]=="♚"&&d==7&&w==6&&(u(1,o[7][7]=" ",o),u(2,f[7][7]="n",f),u(1,o[7][5]="♜",o),u(2,f[7][5]="w",f)),W[0]=="♚"&&d==7&&w==2&&(u(1,o[7][0]=" ",o),u(2,f[7][0]="n",f),u(1,o[7][3]="♜",o),u(2,f[7][3]="w",f)),E.move(D[0],H+j),setTimeout(()=>{u(0,g=!0);var _=Object.entries(E.aiMove(3))[0],U=Y.indexOf(_[0][0]),m=ge.indexOf(_[0][1]),p=Y.indexOf(_[1][0]),G=ge.indexOf(_[1][1]),a=[o[m][U],f[m][U]];o[G][p],f[G][p],u(1,o[m][U]=" ",o),u(2,f[m][U]="n",f),u(1,o[G][p]=a[0],o),u(2,f[G][p]=a[1],f),u(0,g=!1)},500)};return[g,o,f,A,B,T,(d,w,j,H)=>B(d,w,j,H),()=>u(3,A=[]),(d,w,j)=>!g&&A.includes(d+w)?(j.preventDefault(),!0):!1,(d,w,j,H)=>T(d,w,j,H)]}class ot extends Ve{constructor(P){super(),ze(this,P,it,tt,qe,{})}}export{ot as component};
