import{s as Je,n as Ce,r as ze}from"../chunks/scheduler.e108d1fd.js";import{S as Ve,i as Ye,g as N,s as Z,e as ye,h as R,y as se,c as x,j as z,f as m,k as S,a as V,x as T,z as fe,m as ce,n as ae,A as ge,o as Xe}from"../chunks/index.f2f39a4a.js";function ee(o){return(o==null?void 0:o.length)!==void 0?o:Array.from(o)}var Ze=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function xe(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var Re={exports:{}};(function(o,s){(function(l,c){o.exports=c()})(Ze,function(){return function(l){var c={};function u(f){if(c[f])return c[f].exports;var g=c[f]={i:f,l:!1,exports:{}};return l[f].call(g.exports,g,g.exports,u),g.l=!0,g.exports}return u.m=l,u.c=c,u.d=function(f,g,d){u.o(f,g)||Object.defineProperty(f,g,{enumerable:!0,get:d})},u.r=function(f){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(f,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(f,"__esModule",{value:!0})},u.t=function(f,g){if(1&g&&(f=u(f)),8&g||4&g&&typeof f=="object"&&f&&f.__esModule)return f;var d=Object.create(null);if(u.r(d),Object.defineProperty(d,"default",{enumerable:!0,value:f}),2&g&&typeof f!="string")for(var A in f)u.d(d,A,(function(B){return f[B]}).bind(null,A));return d},u.n=function(f){var g=f&&f.__esModule?function(){return f.default}:function(){return f};return u.d(g,"a",g),g},u.o=function(f,g){return Object.prototype.hasOwnProperty.call(f,g)},u.p="",u(u.s=0)}([function(l,c,u){u.r(c),u.d(c,"Game",function(){return ie}),u.d(c,"moves",function(){return We}),u.d(c,"status",function(){return Ue}),u.d(c,"getFen",function(){return Ie}),u.d(c,"move",function(){return Qe}),u.d(c,"aiMove",function(){return qe});const f=["A","B","C","D","E","F","G","H"],g=["1","2","3","4","5","6","7","8"],d={KING_W:"K",QUEEN_W:"Q",ROOK_W:"R",BISHOP_W:"B",KNIGHT_W:"N",PAWN_W:"P",KING_B:"k",QUEEN_B:"q",ROOK_B:"r",BISHOP_B:"b",KNIGHT_B:"n",PAWN_B:"p"},A="black",B="white",y=[0,1,2,3,4],k={0:1,1:2,2:2,3:3,4:3,5:4},F={0:2,1:2,2:4,3:4,4:5,5:5},G={fullMove:1,halfMove:0,enPassant:null,isFinished:!1,checkMate:!1,check:!1,turn:B},b=Object.assign({pieces:{E1:"K",D1:"Q",A1:"R",H1:"R",C1:"B",F1:"B",B1:"N",G1:"N",A2:"P",B2:"P",C2:"P",D2:"P",E2:"P",F2:"P",G2:"P",H2:"P",E8:"k",D8:"q",A8:"r",H8:"r",C8:"b",F8:"b",B8:"n",G8:"n",A7:"p",B7:"p",C7:"p",D7:"p",E7:"p",F7:"p",G7:"p",H7:"p"},castling:{whiteShort:!0,blackShort:!0,whiteLong:!0,blackLong:!0}},G),D={UP:{A1:"A2",A2:"A3",A3:"A4",A4:"A5",A5:"A6",A6:"A7",A7:"A8",A8:null,B1:"B2",B2:"B3",B3:"B4",B4:"B5",B5:"B6",B6:"B7",B7:"B8",B8:null,C1:"C2",C2:"C3",C3:"C4",C4:"C5",C5:"C6",C6:"C7",C7:"C8",C8:null,D1:"D2",D2:"D3",D3:"D4",D4:"D5",D5:"D6",D6:"D7",D7:"D8",D8:null,E1:"E2",E2:"E3",E3:"E4",E4:"E5",E5:"E6",E6:"E7",E7:"E8",E8:null,F1:"F2",F2:"F3",F3:"F4",F4:"F5",F5:"F6",F6:"F7",F7:"F8",F8:null,G1:"G2",G2:"G3",G3:"G4",G4:"G5",G5:"G6",G6:"G7",G7:"G8",G8:null,H1:"H2",H2:"H3",H3:"H4",H4:"H5",H5:"H6",H6:"H7",H7:"H8",H8:null},DOWN:{A1:null,A2:"A1",A3:"A2",A4:"A3",A5:"A4",A6:"A5",A7:"A6",A8:"A7",B1:null,B2:"B1",B3:"B2",B4:"B3",B5:"B4",B6:"B5",B7:"B6",B8:"B7",C1:null,C2:"C1",C3:"C2",C4:"C3",C5:"C4",C6:"C5",C7:"C6",C8:"C7",D1:null,D2:"D1",D3:"D2",D4:"D3",D5:"D4",D6:"D5",D7:"D6",D8:"D7",E1:null,E2:"E1",E3:"E2",E4:"E3",E5:"E4",E6:"E5",E7:"E6",E8:"E7",F1:null,F2:"F1",F3:"F2",F4:"F3",F5:"F4",F6:"F5",F7:"F6",F8:"F7",G1:null,G2:"G1",G3:"G2",G4:"G3",G5:"G4",G6:"G5",G7:"G6",G8:"G7",H1:null,H2:"H1",H3:"H2",H4:"H3",H5:"H4",H6:"H5",H7:"H6",H8:"H7"},LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:"A1",B2:"A2",B3:"A3",B4:"A4",B5:"A5",B6:"A6",B7:"A7",B8:"A8",C1:"B1",C2:"B2",C3:"B3",C4:"B4",C5:"B5",C6:"B6",C7:"B7",C8:"B8",D1:"C1",D2:"C2",D3:"C3",D4:"C4",D5:"C5",D6:"C6",D7:"C7",D8:"C8",E1:"D1",E2:"D2",E3:"D3",E4:"D4",E5:"D5",E6:"D6",E7:"D7",E8:"D8",F1:"E1",F2:"E2",F3:"E3",F4:"E4",F5:"E5",F6:"E6",F7:"E7",F8:"E8",G1:"F1",G2:"F2",G3:"F3",G4:"F4",G5:"F5",G6:"F6",G7:"F7",G8:"F8",H1:"G1",H2:"G2",H3:"G3",H4:"G4",H5:"G5",H6:"G6",H7:"G7",H8:"G8"},RIGHT:{A1:"B1",A2:"B2",A3:"B3",A4:"B4",A5:"B5",A6:"B6",A7:"B7",A8:"B8",B1:"C1",B2:"C2",B3:"C3",B4:"C4",B5:"C5",B6:"C6",B7:"C7",B8:"C8",C1:"D1",C2:"D2",C3:"D3",C4:"D4",C5:"D5",C6:"D6",C7:"D7",C8:"D8",D1:"E1",D2:"E2",D3:"E3",D4:"E4",D5:"E5",D6:"E6",D7:"E7",D8:"E8",E1:"F1",E2:"F2",E3:"F3",E4:"F4",E5:"F5",E6:"F6",E7:"F7",E8:"F8",F1:"G1",F2:"G2",F3:"G3",F4:"G4",F5:"G5",F6:"G6",F7:"G7",F8:"G8",G1:"H1",G2:"H2",G3:"H3",G4:"H4",G5:"H5",G6:"H6",G7:"H7",G8:"H8",H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},UP_LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:"A2",B2:"A3",B3:"A4",B4:"A5",B5:"A6",B6:"A7",B7:"A8",B8:null,C1:"B2",C2:"B3",C3:"B4",C4:"B5",C5:"B6",C6:"B7",C7:"B8",C8:null,D1:"C2",D2:"C3",D3:"C4",D4:"C5",D5:"C6",D6:"C7",D7:"C8",D8:null,E1:"D2",E2:"D3",E3:"D4",E4:"D5",E5:"D6",E6:"D7",E7:"D8",E8:null,F1:"E2",F2:"E3",F3:"E4",F4:"E5",F5:"E6",F6:"E7",F7:"E8",F8:null,G1:"F2",G2:"F3",G3:"F4",G4:"F5",G5:"F6",G6:"F7",G7:"F8",G8:null,H1:"G2",H2:"G3",H3:"G4",H4:"G5",H5:"G6",H6:"G7",H7:"G8",H8:null},DOWN_RIGHT:{A1:null,A2:"B1",A3:"B2",A4:"B3",A5:"B4",A6:"B5",A7:"B6",A8:"B7",B1:null,B2:"C1",B3:"C2",B4:"C3",B5:"C4",B6:"C5",B7:"C6",B8:"C7",C1:null,C2:"D1",C3:"D2",C4:"D3",C5:"D4",C6:"D5",C7:"D6",C8:"D7",D1:null,D2:"E1",D3:"E2",D4:"E3",D5:"E4",D6:"E5",D7:"E6",D8:"E7",E1:null,E2:"F1",E3:"F2",E4:"F3",E5:"F4",E6:"F5",E7:"F6",E8:"F7",F1:null,F2:"G1",F3:"G2",F4:"G3",F5:"G4",F6:"G5",F7:"G6",F8:"G7",G1:null,G2:"H1",G3:"H2",G4:"H3",G5:"H4",G6:"H5",G7:"H6",G8:"H7",H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},UP_RIGHT:{A1:"B2",A2:"B3",A3:"B4",A4:"B5",A5:"B6",A6:"B7",A7:"B8",A8:null,B1:"C2",B2:"C3",B3:"C4",B4:"C5",B5:"C6",B6:"C7",B7:"C8",B8:null,C1:"D2",C2:"D3",C3:"D4",C4:"D5",C5:"D6",C6:"D7",C7:"D8",C8:null,D1:"E2",D2:"E3",D3:"E4",D4:"E5",D5:"E6",D6:"E7",D7:"E8",D8:null,E1:"F2",E2:"F3",E3:"F4",E4:"F5",E5:"F6",E6:"F7",E7:"F8",E8:null,F1:"G2",F2:"G3",F3:"G4",F4:"G5",F5:"G6",F6:"G7",F7:"G8",F8:null,G1:"H2",G2:"H3",G3:"H4",G4:"H5",G5:"H6",G6:"H7",G7:"H8",G8:null,H1:null,H2:null,H3:null,H4:null,H5:null,H6:null,H7:null,H8:null},DOWN_LEFT:{A1:null,A2:null,A3:null,A4:null,A5:null,A6:null,A7:null,A8:null,B1:null,B2:"A1",B3:"A2",B4:"A3",B5:"A4",B6:"A5",B7:"A6",B8:"A7",C1:null,C2:"B1",C3:"B2",C4:"B3",C5:"B4",C6:"B5",C7:"B6",C8:"B7",D1:null,D2:"C1",D3:"C2",D4:"C3",D5:"C4",D6:"C5",D7:"C6",D8:"C7",E1:null,E2:"D1",E3:"D2",E4:"D3",E5:"D4",E6:"D5",E7:"D6",E8:"D7",F1:null,F2:"E1",F3:"E2",F4:"E3",F5:"E4",F6:"E5",F7:"E6",F8:"E7",G1:null,G2:"F1",G3:"F2",G4:"F3",G5:"F4",G6:"F5",G7:"F6",G8:"F7",H1:null,H2:"G1",H3:"G2",H4:"G3",H5:"G4",H6:"G5",H7:"G6",H8:"G7"}},Y=[[0,0,0,0,0,0,0,0],[5,5,5,5,5,5,5,5],[1,1,2,3,3,2,1,1],[.5,.5,1,2.5,2.5,1,.5,.5],[0,0,0,2,2,0,0,0],[.5,0,1,0,0,1,0,.5],[.5,0,0,-2,-2,0,0,.5],[0,0,0,0,0,0,0,0]],v=[[-4,-3,-2,-2,-2,-2,-3,-4],[-3,-2,0,0,0,0,-2,-3],[-2,0,1,1.5,1.5,1,0,-2],[-2,.5,1.5,2,2,1.5,.5,-2],[-2,0,1.5,2,2,1.5,0,-2],[-2,.5,1,1.5,1.5,1,.5,-2],[-3,-2,0,.5,.5,0,-2,-3],[-4,-3,-2,-2,-2,-2,-3,-4]],L=[[-2,-1,-1,-1,-1,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,1,1,.5,0,-1],[-1,.5,.5,1,1,.5,.5,-1],[-1,0,1,1,1,1,0,-1],[-1,1,1,1,1,1,1,-1],[-1,.5,0,0,0,0,.5,-1],[-2,-1,-1,-1,-1,-1,-1,-2]],W=[[0,0,0,0,0,0,0,0],[.5,1,1,1,1,1,1,.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[-.5,0,0,0,0,0,0,-.5],[0,0,0,.5,.5,0,0,0]],w=[[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-3,-4,-4,-5,-5,-4,-4,-3],[-2,-3,-3,-4,-4,-3,-3,-2],[-1,-2,-2,-2,-2,-2,-2,-1],[2,2,0,0,0,0,2,2],[2,3,1,0,0,1,3,2]],q=[[-2,-1,-1,-.5,-.5,-1,-1,-2],[-1,0,0,0,0,0,0,-1],[-1,0,.5,.5,.5,.5,0,-1],[-.5,0,.5,.5,.5,.5,0,-.5],[0,0,.5,.5,.5,.5,0,-.5],[-1,.5,.5,.5,.5,.5,0,-1],[-1,0,.5,0,0,0,0,-1],[-2,-1,-1,-.5,-.5,-1,-1,-2]],M={P:Y.slice().reverse(),p:Y,N:v.slice().reverse(),n:v,B:L.slice().reverse(),b:L,R:W.slice().reverse(),r:W,K:w.slice().reverse(),k:w,Q:q.slice().reverse(),q};function Q(C){return D.UP[C]}function _(C){return D.DOWN[C]}function U(C){return D.LEFT[C]}function j(C){return D.RIGHT[C]}function H(C){return D.UP_LEFT[C]}function p(C){return D.UP_RIGHT[C]}function O(C){return D.DOWN_LEFT[C]}function P(C){return D.DOWN_RIGHT[C]}function I(C){const t=H(C);return t?Q(t):null}function J(C){const t=H(C);return t?U(t):null}function be(C){const t=p(C);return t?Q(t):null}function Fe(C){const t=p(C);return t?j(t):null}function De(C){const t=O(C);return t?_(t):null}function ve(C){const t=O(C);return t?U(t):null}function Ge(C){const t=P(C);return t?_(t):null}function He(C){const t=P(C);return t?j(t):null}function Ae(C,t){return t===B?D.UP[C]:D.DOWN[C]}function Pe(C,t){return t===B?D.UP_LEFT[C]:D.DOWN_RIGHT[C]}function Ee(C,t){return t===B?D.UP_RIGHT[C]:D.DOWN_LEFT[C]}function _e(C,t){return t===B?D.DOWN_LEFT[C]:D.UP_RIGHT[C]}function ke(C,t){return t===B?D.DOWN_RIGHT[C]:D.UP_LEFT[C]}function oe(C){return{k:10,q:9,r:5,b:3,n:3,p:1}[C.toLowerCase()]||0}function he(C){return typeof C=="string"&&C.match("^[a-hA-H]{1}[1-8]{1}$")}const de=-1e3,Be=1e3;class ue{constructor(t=JSON.parse(JSON.stringify(b))){if(typeof t=="object")this.configuration=Object.assign({},G,t);else{if(typeof t!="string")throw new Error(`Unknown configuration type ${typeof config}.`);this.configuration=Object.assign({},G,function(i=""){const[n,r,e,h,E,a]=i.split(" "),K={pieces:Object.fromEntries(n.split("/").flatMap((X,re)=>{let $=0;return X.split("").reduce((le,ne)=>{const we=ne.match(/k|b|q|n|p|r/i);we&&(le.push([`${f[$]}${g[7-re]}`,we[0]]),$+=1);const me=ne.match(/[1-8]/);return me&&($+=Number(me)),le},[])}))};return K.turn=r==="b"?A:B,K.castling={whiteLong:!1,whiteShort:!1,blackLong:!1,blackShort:!1},e.includes("K")&&(K.castling.whiteShort=!0),e.includes("k")&&(K.castling.blackShort=!0),e.includes("Q")&&(K.castling.whiteLong=!0),e.includes("q")&&(K.castling.blackLong=!0),he(h)&&(K.enPassant=h.toUpperCase()),K.halfMove=parseInt(E),K.fullMove=parseInt(a),K}(t))}this.configuration.castling||(this.configuration.castling={whiteShort:!0,blackShort:!0,whiteLong:!0,blackLong:!0}),this.history=[]}getAttackingFields(t=this.getPlayingColor()){let i=[];for(const n in this.configuration.pieces){const r=this.getPiece(n);this.getPieceColor(r)===t&&(i=[...i,...this.getPieceMoves(r,n)])}return i}isAttackingKing(t=this.getPlayingColor()){let i=null;for(const n in this.configuration.pieces){const r=this.getPiece(n);if(this.isKing(r)&&this.getPieceColor(r)!==t){i=n;break}}return this.isPieceUnderAttack(i)}isPieceUnderAttack(t){const i=this.getPieceOnLocationColor(t),n=this.getEnemyColor(i);let r=!1,e=t,h=0;for(;Q(e)&&!r;){e=Q(e),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isRook(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}for(e=t,h=0;_(e)&&!r;){e=_(e),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isRook(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}for(e=t,h=0;U(e)&&!r;){e=U(e),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isRook(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}for(e=t,h=0;j(e)&&!r;){e=j(e),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isRook(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}for(e=t,h=0;Ee(e,i)&&!r;){e=Ee(e,i),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isBishop(a)||this.isQueen(a)||h===1&&(this.isKing(a)||this.isPawn(a)))&&(r=!0),a)break}for(e=t,h=0;Pe(e,i)&&!r;){e=Pe(e,i),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isBishop(a)||this.isQueen(a)||h===1&&(this.isKing(a)||this.isPawn(a)))&&(r=!0),a)break}for(e=t,h=0;ke(e,i)&&!r;){e=ke(e,i),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isBishop(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}for(e=t,h=0;_e(e,i)&&!r;){e=_e(e,i),h++;const a=this.getPiece(e);if(a&&this.getPieceColor(a)===n&&(this.isBishop(a)||this.isQueen(a)||this.isKing(a)&&h===1)&&(r=!0),a)break}e=be(t);let E=this.getPiece(e);return E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=Fe(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=J(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=I(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=De(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=ve(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=Ge(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),e=He(t),E=this.getPiece(e),E&&this.getPieceColor(E)===n&&this.isKnight(E)&&(r=!0),r}hasPlayingPlayerCheck(){return this.isAttackingKing(this.getNonPlayingColor())}hasNonPlayingPlayerCheck(){return this.isAttackingKing(this.getPlayingColor())}getLowestValuePieceAttackingLocation(t,i=this.getPlayingColor()){let n=null;for(const r in this.configuration.pieces){const e=this.getPiece(r);this.getPieceColor(e)===i&&this.getPieceMoves(e,r).map(h=>{h===t&&(n===null||oe(e)<n)&&(n=oe(e))})}return n}getMoves(t=this.getPlayingColor(),i=null){const n={};let r=0;for(const E in this.configuration.pieces){const a=this.getPiece(E);if(this.getPieceColor(a)===t){const K=this.getPieceMoves(a,E);K.length&&r++,Object.assign(n,{[E]:K})}}const e=this.getAttackingFields(this.getNonPlayingColor());if(this.isLeftCastlingPossible(e)&&(this.isPlayingWhite()&&n.E1.push("C1"),this.isPlayingBlack()&&n.E8.push("C8")),this.isRightCastlingPossible(e)&&(this.isPlayingWhite()&&n.E1.push("G1"),this.isPlayingBlack()&&n.E8.push("G8")),i&&r>i)return n;const h={};for(const E in n)n[E].map(a=>{const K={pieces:Object.assign({},this.configuration.pieces),castling:Object.assign({},this.configuration.castling)},X=new ue(K);X.move(E,a),(this.isPlayingWhite()&&!X.isAttackingKing(A)||this.isPlayingBlack()&&!X.isAttackingKing(B))&&(h[E]||(h[E]=[]),h[E].push(a))});return Object.keys(h).length||(this.configuration.isFinished=!0,this.hasPlayingPlayerCheck()&&(this.configuration.checkMate=!0)),h}isLeftCastlingPossible(t){if(this.isPlayingWhite()&&!this.configuration.castling.whiteLong||this.isPlayingBlack()&&!this.configuration.castling.blackLong)return!1;let i=null;if(this.isPlayingWhite()&&this.getPiece("E1")==="K"&&this.getPiece("A1")==="R"&&!t.includes("E1")?i="E1":this.isPlayingBlack()&&this.getPiece("E8")==="k"&&this.getPiece("A8")==="r"&&!t.includes("E8")&&(i="E8"),!i)return!1;let n=U(i);return!this.getPiece(n)&&!t.includes(n)&&(n=U(n),!this.getPiece(n)&&!t.includes(n)&&(n=U(n),!this.getPiece(n)))}isRightCastlingPossible(t){if(this.isPlayingWhite()&&!this.configuration.castling.whiteShort||this.isPlayingBlack()&&!this.configuration.castling.blackShort)return!1;let i=null;if(this.isPlayingWhite()&&this.getPiece("E1")==="K"&&this.getPiece("H1")==="R"&&!t.includes("E1")?i="E1":this.isPlayingBlack()&&this.getPiece("E8")==="k"&&this.getPiece("H8")==="r"&&!t.includes("E8")&&(i="E8"),!i)return!1;let n=j(i);return!this.getPiece(n)&&!t.includes(n)&&(n=j(n),!this.getPiece(n)&&!t.includes(n))}getPieceMoves(t,i){return this.isPawn(t)?this.getPawnMoves(t,i):this.isKnight(t)?this.getKnightMoves(t,i):this.isRook(t)?this.getRookMoves(t,i):this.isBishop(t)?this.getBishopMoves(t,i):this.isQueen(t)?this.getQueenMoves(t,i):this.isKing(t)?this.getKingMoves(t,i):[]}isPawn(t){return t.toUpperCase()==="P"}isKnight(t){return t.toUpperCase()==="N"}isRook(t){return t.toUpperCase()==="R"}isBishop(t){return t.toUpperCase()==="B"}isQueen(t){return t.toUpperCase()==="Q"}isKing(t){return t.toUpperCase()==="K"}getPawnMoves(t,i){const n=[],r=this.getPieceColor(t);let e=Ae(i,r);return e&&!this.getPiece(e)&&(n.push(e),e=Ae(e,r),function(h,E){return h===B&&E[1]==="2"||h===A&&E[1]==="7"}(r,i)&&e&&!this.getPiece(e)&&n.push(e)),e=Pe(i,r),e&&(this.getPiece(e)&&this.getPieceOnLocationColor(e)!==r||e===this.configuration.enPassant)&&n.push(e),e=Ee(i,r),e&&(this.getPiece(e)&&this.getPieceOnLocationColor(e)!==r||e===this.configuration.enPassant)&&n.push(e),n}getKnightMoves(t,i){const n=[],r=this.getPieceColor(t);let e=be(i);return e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=Fe(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=I(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=J(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=ve(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=De(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=He(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=Ge(i),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),n}getRookMoves(t,i){const n=[],r=this.getPieceColor(t);let e=i;for(;Q(e);){e=Q(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;_(e);){e=_(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;j(e);){e=j(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;U(e);){e=U(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}return n}getBishopMoves(t,i){const n=[],r=this.getPieceColor(t);let e=i;for(;H(e);){e=H(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;p(e);){e=p(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;O(e);){e=O(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}for(e=i;P(e);){e=P(e);const h=this.getPieceOnLocationColor(e);if(this.getPieceOnLocationColor(e)!==r&&n.push(e),h)break}return n}getQueenMoves(t,i){return[...this.getRookMoves(t,i),...this.getBishopMoves(t,i)]}getKingMoves(t,i){const n=[],r=this.getPieceColor(t);let e=i;return e=Q(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=j(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=_(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=U(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=H(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=p(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=O(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),e=i,e=P(e),e&&this.getPieceOnLocationColor(e)!==r&&n.push(e),n}getPieceColor(t){return t.toUpperCase()===t?B:A}getPieceOnLocationColor(t){const i=this.getPiece(t);return i?i.toUpperCase()===i?B:A:null}getPiece(t){return this.configuration.pieces[t]}setPiece(t,i){if(!function(n){return Object.values(d).includes(n)}(i))throw new Error("Invalid piece "+i);if(!he(t))throw new Error("Invalid location "+t);this.configuration.pieces[t.toUpperCase()]=i}removePiece(t){if(!he(t))throw new Error("Invalid location "+t);delete this.configuration.pieces[t.toUpperCase()]}isEmpty(t){if(!he(t))throw new Error("Invalid location "+t);return!this.configuration.pieces[t.toUpperCase()]}getEnemyColor(t){return t===B?A:B}getPlayingColor(){return this.configuration.turn}getNonPlayingColor(){return this.isPlayingWhite()?A:B}isPlayingWhite(){return this.configuration.turn===B}isPlayingBlack(){return this.configuration.turn===A}addMoveToHistory(t,i){this.history.push({from:t,to:i,configuration:JSON.parse(JSON.stringify(this.configuration))})}move(t,i){const n=this.getPiece(t),r=this.getPiece(i);if(!n)throw new Error("There is no piece at "+t);var e,h;if(Object.assign(this.configuration.pieces,{[i]:n}),delete this.configuration.pieces[t],this.isPlayingWhite()&&this.isPawn(n)&&i[1]==="8"&&Object.assign(this.configuration.pieces,{[i]:"Q"}),this.isPlayingBlack()&&this.isPawn(n)&&i[1]==="1"&&Object.assign(this.configuration.pieces,{[i]:"q"}),this.isPawn(n)&&i===this.configuration.enPassant&&delete this.configuration.pieces[e=i,h=this.getPlayingColor(),h===B?D.DOWN[e]:D.UP[e]],this.isPawn(n)&&this.isPlayingWhite()&&t[1]==="2"&&i[1]==="4"?this.configuration.enPassant=t[0]+"3":this.isPawn(n)&&this.isPlayingBlack()&&t[1]==="7"&&i[1]==="5"?this.configuration.enPassant=t[0]+"6":this.configuration.enPassant=null,t==="E1"&&Object.assign(this.configuration.castling,{whiteLong:!1,whiteShort:!1}),t==="E8"&&Object.assign(this.configuration.castling,{blackLong:!1,blackShort:!1}),t==="A1"&&Object.assign(this.configuration.castling,{whiteLong:!1}),t==="H1"&&Object.assign(this.configuration.castling,{whiteShort:!1}),t==="A8"&&Object.assign(this.configuration.castling,{blackLong:!1}),t==="H8"&&Object.assign(this.configuration.castling,{blackShort:!1}),this.isKing(n)){if(t==="E1"&&i==="C1")return this.move("A1","D1");if(t==="E8"&&i==="C8")return this.move("A8","D8");if(t==="E1"&&i==="G1")return this.move("H1","F1");if(t==="E8"&&i==="G8")return this.move("H8","F8")}this.configuration.turn=this.isPlayingWhite()?A:B,this.isPlayingWhite()&&this.configuration.fullMove++,this.configuration.halfMove++,(r||this.isPawn(n))&&(this.configuration.halfMove=0)}exportJson(){return{moves:this.getMoves(),pieces:this.configuration.pieces,turn:this.configuration.turn,isFinished:this.configuration.isFinished,check:this.hasPlayingPlayerCheck(),checkMate:this.configuration.checkMate,castling:this.configuration.castling,enPassant:this.configuration.enPassant,halfMove:this.configuration.halfMove,fullMove:this.configuration.fullMove}}calculateAiMove(t){return this.calculateAiMoves(t)[0]}calculateAiMoves(t){if(t=parseInt(t),!y.includes(t))throw new Error(`Invalid level ${t}. You can choose ${y.join(",")}`);this.shouldIncreaseLevel()&&t++;const i=[],n=this.calculateScore(this.getPlayingColor()),r=this.getMoves();for(const e in r)r[e].map(h=>{const E=this.getTestBoard(),a=!!E.getPiece(h);E.move(e,h),i.push({from:e,to:h,score:E.testMoveScores(this.getPlayingColor(),t,a,a?E.calculateScore(this.getPlayingColor()):n,h).score+E.calculateScoreByPiecesLocation(this.getPlayingColor())+Math.floor(Math.random()*(this.configuration.halfMove>10?this.configuration.halfMove-10:1)*10)/10})});return i.sort((e,h)=>e.score<h.score?1:e.score>h.score?-1:0),i}shouldIncreaseLevel(){return this.getIngamePiecesValue()<50}getIngamePiecesValue(){let t=0;for(const i in this.configuration.pieces)t+=oe(this.getPiece(i));return t}getTestBoard(){const t={pieces:Object.assign({},this.configuration.pieces),castling:Object.assign({},this.configuration.castling),turn:this.configuration.turn,enPassant:this.configuration.enPassant};return new ue(t)}testMoveScores(t,i,n,r,e,h=1){let E=null;if(h<F[i]&&this.hasPlayingPlayerCheck()?E=this.getMoves(this.getPlayingColor()):(h<k[i]||n&&h<F[i])&&(E=this.getMoves(this.getPlayingColor(),5)),this.configuration.isFinished)return{score:this.calculateScore(t)+(this.getPlayingColor()===t?h:-h),max:!0};if(!E)return r!==null?{score:r,max:!1}:{score:this.calculateScore(t),max:!1};let a=this.getPlayingColor()===t?de:Be,K=!1;for(const X in E)K||E[X].map(re=>{if(K)return;const $=this.getTestBoard(),le=!!$.getPiece(re);if($.move(X,re),$.hasNonPlayingPlayerCheck())return;const ne=$.testMoveScores(t,i,le,le?$.calculateScore(t):r,re,h+1);ne.max&&(K=!0),a=this.getPlayingColor()===t?Math.max(a,ne.score):Math.min(a,ne.score)});return{score:a,max:!1}}calculateScoreByPiecesLocation(t=this.getPlayingColor()){const i={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7};let n=0;for(const r in this.configuration.pieces){const e=this.getPiece(r);if(M[e]){const h=M[e][r[1]-1][i[r[0]]];n+=.5*(this.getPieceColor(e)===t?h:-h)}}return n}calculateScore(t=this.getPlayingColor()){let i=0;if(this.configuration.checkMate)return this.getPlayingColor()===t?de:Be;if(this.configuration.isFinished)return this.getPlayingColor()===t?Be:de;for(const n in this.configuration.pieces){const r=this.getPiece(n);this.getPieceColor(r)===t?i+=10*oe(r):i-=10*oe(r)}return i}}class ie{constructor(t){this.board=new ue(t)}move(t,i){t=t.toUpperCase(),i=i.toUpperCase();const n=this.board.getMoves();if(!n[t]||!n[t].includes(i))throw new Error(`Invalid move from ${t} to ${i} for ${this.board.getPlayingColor()}`);return this.board.addMoveToHistory(t,i),this.board.move(t,i),{[t]:i}}moves(t=null){return(t?this.board.getMoves()[t.toUpperCase()]:this.board.getMoves())||[]}setPiece(t,i){this.board.setPiece(t,i)}removePiece(t){this.board.removePiece(t)}aiMove(t=2){const i=this.board.calculateAiMove(t);return this.move(i.from,i.to)}getHistory(t=!1){return t?this.board.history.reverse():this.board.history}printToConsole(){(function(t){process.stdout.write(`
`);let i=B;Object.assign([],g).reverse().map(n=>{process.stdout.write(""+n),f.map(r=>{switch(t.pieces[`${r}${n}`]){case"K":process.stdout.write("♚");break;case"Q":process.stdout.write("♛");break;case"R":process.stdout.write("♜");break;case"B":process.stdout.write("♝");break;case"N":process.stdout.write("♞");break;case"P":process.stdout.write("♟");break;case"k":process.stdout.write("♔");break;case"q":process.stdout.write("♕");break;case"r":process.stdout.write("♖");break;case"b":process.stdout.write("♗");break;case"n":process.stdout.write("♘");break;case"p":process.stdout.write("♙");break;default:process.stdout.write(i===B?"█":"░")}i=i===B?A:B}),i=i===B?A:B,process.stdout.write(`
`)}),process.stdout.write(" "),f.map(n=>{process.stdout.write(""+n)}),process.stdout.write(`
`)})(this.board.configuration)}exportJson(){return this.board.exportJson()}exportFEN(){return function(t){let i="";Object.assign([],g).reverse().map(E=>{let a=0;E<8&&(i+="/"),f.map(K=>{const X=t.pieces[`${K}${E}`];X?(a&&(i+=a.toString(),a=0),i+=X):a++}),i+=""+(a||"")}),i+=t.turn===B?" w ":" b ";const{whiteShort:n,whiteLong:r,blackLong:e,blackShort:h}=t.castling;return r||n||e||h?(n&&(i+="K"),r&&(i+="Q"),h&&(i+="k"),e&&(i+="q")):i+="-",i+=" "+(t.enPassant?t.enPassant.toLowerCase():"-"),i+=" "+t.halfMove,i+=" "+t.fullMove,i}(this.board.configuration)}}function We(C){if(!C)throw new Error("Configuration param required.");return new ie(C).moves()}function Ue(C){if(!C)throw new Error("Configuration param required.");return new ie(C).exportJson()}function Ie(C){if(!C)throw new Error("Configuration param required.");return new ie(C).exportFEN()}function Qe(C,t,i){if(!C)throw new Error("Configuration param required.");const n=new ie(C);return n.move(t,i),typeof C=="object"?n.exportJson():n.exportFEN()}function qe(C,t=2){if(!C)throw new Error("Configuration param required.");const i=new ie(C).board.calculateAiMove(t);return{[i.from]:i.to}}}])})})(Re);var $e=Re.exports;const et=xe($e);function Oe(o,s,l){const c=o.slice();return c[14]=s[l],c}function Le(o,s,l){const c=o.slice();return c[17]=s[l],c[19]=l,c}function Me(o,s,l){const c=o.slice();return c[14]=s[l],c[21]=l,c}function je(o,s,l){const c=o.slice();return c[14]=s[l],c}function Te(o){let s,l=o[14]+"",c;return{c(){s=N("td"),c=ce(l),this.h()},l(u){s=R(u,"TD",{class:!0});var f=z(s);c=ae(f,l),f.forEach(m),this.h()},h(){S(s,"class","s svelte-1t6hsyj")},m(u,f){V(u,s,f),T(s,c)},p:Ce,d(u){u&&m(s)}}}function Ke(o){let s,l,c=o[2][o[19]][o[21]]+"",u,f,g,d,A,B;function y(){return o[8](o[19],o[21],o[17],o[14])}function k(...G){return o[10](o[14],o[17],...G)}function F(){return o[11](o[19],o[21],o[17],o[14])}return{c(){s=N("td"),l=N("span"),u=ce(c),this.h()},l(G){s=R(G,"TD",{class:!0});var b=z(s);l=R(b,"SPAN",{class:!0,draggable:!0});var D=z(l);u=ae(D,c),D.forEach(m),b.forEach(m),this.h()},h(){S(l,"class",f=o[3][o[19]][o[21]]+" "+(!o[0]&&o[1][1]==o[14]+o[17]?"u":"")+" svelte-1t6hsyj"),S(l,"draggable",g=!o[0]&&o[3][o[19]][o[21]]=="w"),S(s,"class",d="s"+(o[19]+o[21])%2+" "+(!o[0]&&o[4].includes(o[14]+o[17])?"x":"")+" svelte-1t6hsyj")},m(G,b){V(G,s,b),T(s,l),T(l,u),A||(B=[ge(l,"dragstart",y),ge(l,"dragend",o[9]),ge(s,"dragover",k),ge(s,"drop",F)],A=!0)},p(G,b){o=G,b&4&&c!==(c=o[2][o[19]][o[21]]+"")&&Xe(u,c),b&11&&f!==(f=o[3][o[19]][o[21]]+" "+(!o[0]&&o[1][1]==o[14]+o[17]?"u":"")+" svelte-1t6hsyj")&&S(l,"class",f),b&9&&g!==(g=!o[0]&&o[3][o[19]][o[21]]=="w")&&S(l,"draggable",g),b&17&&d!==(d="s"+(o[19]+o[21])%2+" "+(!o[0]&&o[4].includes(o[14]+o[17])?"x":"")+" svelte-1t6hsyj")&&S(s,"class",d)},d(G){G&&m(s),A=!1,ze(B)}}}function Se(o){let s,l,c=8-o[19]+"",u,f,g,d,A=8-o[19]+"",B,y=ee(te),k=[];for(let F=0;F<y.length;F+=1)k[F]=Ke(Me(o,y,F));return{c(){s=N("tr"),l=N("td"),u=ce(c),f=Z();for(let F=0;F<k.length;F+=1)k[F].c();g=Z(),d=N("td"),B=ce(A),this.h()},l(F){s=R(F,"TR",{});var G=z(s);l=R(G,"TD",{class:!0});var b=z(l);u=ae(b,c),b.forEach(m),f=x(G);for(let Y=0;Y<k.length;Y+=1)k[Y].l(G);g=x(G),d=R(G,"TD",{class:!0});var D=z(d);B=ae(D,A),D.forEach(m),G.forEach(m),this.h()},h(){S(l,"class","o svelte-1t6hsyj"),S(d,"class","o svelte-1t6hsyj")},m(F,G){V(F,s,G),T(s,l),T(l,u),T(s,f);for(let b=0;b<k.length;b+=1)k[b]&&k[b].m(s,null);T(s,g),T(s,d),T(d,B)},p(F,G){if(G&223){y=ee(te);let b;for(b=0;b<y.length;b+=1){const D=Me(F,y,b);k[b]?k[b].p(D,G):(k[b]=Ke(D),k[b].c(),k[b].m(s,g))}for(;b<k.length;b+=1)k[b].d(1);k.length=y.length}},d(F){F&&m(s),fe(k,F)}}}function Ne(o){let s,l=o[14]+"",c;return{c(){s=N("td"),c=ce(l),this.h()},l(u){s=R(u,"TD",{class:!0});var f=z(s);c=ae(f,l),f.forEach(m),this.h()},h(){S(s,"class","s svelte-1t6hsyj")},m(u,f){V(u,s,f),T(s,c)},p:Ce,d(u){u&&m(s)}}}function tt(o){let s,l=" ";return{c(){s=N("h2"),s.textContent=l,this.h()},l(c){s=R(c,"H2",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-slfcfw"&&(s.textContent=l),this.h()},h(){S(s,"class","svelte-1t6hsyj")},m(c,u){V(c,s,u)},d(c){c&&m(s)}}}function it(o){let s,l="Te lépsz!";return{c(){s=N("h2"),s.textContent=l,this.h()},l(c){s=R(c,"H2",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-1ndxojg"&&(s.textContent=l),this.h()},h(){S(s,"class","svelte-1t6hsyj")},m(c,u){V(c,s,u)},d(c){c&&m(s)}}}function nt(o){let s,l="Sakk";return{c(){s=N("h2"),s.textContent=l,this.h()},l(c){s=R(c,"H2",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-104b34s"&&(s.textContent=l),this.h()},h(){S(s,"class","svelte-1t6hsyj")},m(c,u){V(c,s,u)},d(c){c&&m(s)}}}function st(o){let s,l="Döntetlen";return{c(){s=N("h2"),s.textContent=l,this.h()},l(c){s=R(c,"H2",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-2zs3iy"&&(s.textContent=l),this.h()},h(){S(s,"class","svelte-1t6hsyj")},m(c,u){V(c,s,u)},d(c){c&&m(s)}}}function ot(o){let s,l="Matt";return{c(){s=N("h2"),s.textContent=l,this.h()},l(c){s=R(c,"H2",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-1079gac"&&(s.textContent=l),this.h()},h(){S(s,"class","svelte-1t6hsyj")},m(c,u){V(c,s,u)},d(c){c&&m(s)}}}function rt(o){let s,l="Sakk",c,u,f,g,d,A,B,y,k,F,G,b,D,Y,v,L,W=ee(te),w=[];for(let p=0;p<W.length;p+=1)w[p]=Te(je(o,W,p));let q=ee(pe),M=[];for(let p=0;p<q.length;p+=1)M[p]=Se(Le(o,q,p));let Q=ee(te),_=[];for(let p=0;p<Q.length;p+=1)_[p]=Ne(Oe(o,Q,p));function U(p,O){return p[5].checkMate?ot:p[5].isFinished?st:p[5].check?nt:p[0]?tt:it}let j=U(o),H=j(o);return{c(){s=N("h1"),s.textContent=l,c=Z(),u=N("table"),f=N("tr"),g=N("td"),d=Z();for(let p=0;p<w.length;p+=1)w[p].c();A=Z(),B=N("td"),y=Z();for(let p=0;p<M.length;p+=1)M[p].c();k=Z(),F=N("tr"),G=N("td"),b=Z();for(let p=0;p<_.length;p+=1)_[p].c();D=Z(),Y=N("td"),v=Z(),H.c(),L=ye(),this.h()},l(p){s=R(p,"H1",{class:!0,"data-svelte-h":!0}),se(s)!=="svelte-masb5y"&&(s.textContent=l),c=x(p),u=R(p,"TABLE",{class:!0});var O=z(u);f=R(O,"TR",{});var P=z(f);g=R(P,"TD",{class:!0}),z(g).forEach(m),d=x(P);for(let J=0;J<w.length;J+=1)w[J].l(P);A=x(P),B=R(P,"TD",{class:!0}),z(B).forEach(m),P.forEach(m),y=x(O);for(let J=0;J<M.length;J+=1)M[J].l(O);k=x(O),F=R(O,"TR",{});var I=z(F);G=R(I,"TD",{class:!0}),z(G).forEach(m),b=x(I);for(let J=0;J<_.length;J+=1)_[J].l(I);D=x(I),Y=R(I,"TD",{class:!0}),z(Y).forEach(m),I.forEach(m),O.forEach(m),v=x(p),H.l(p),L=ye(),this.h()},h(){S(s,"class","svelte-1t6hsyj"),S(g,"class","c svelte-1t6hsyj"),S(B,"class","c svelte-1t6hsyj"),S(G,"class","c svelte-1t6hsyj"),S(Y,"class","c svelte-1t6hsyj"),S(u,"class","svelte-1t6hsyj")},m(p,O){V(p,s,O),V(p,c,O),V(p,u,O),T(u,f),T(f,g),T(f,d);for(let P=0;P<w.length;P+=1)w[P]&&w[P].m(f,null);T(f,A),T(f,B),T(u,y);for(let P=0;P<M.length;P+=1)M[P]&&M[P].m(u,null);T(u,k),T(u,F),T(F,G),T(F,b);for(let P=0;P<_.length;P+=1)_[P]&&_[P].m(F,null);T(F,D),T(F,Y),V(p,v,O),H.m(p,O),V(p,L,O)},p(p,[O]){if(O&0){W=ee(te);let P;for(P=0;P<W.length;P+=1){const I=je(p,W,P);w[P]?w[P].p(I,O):(w[P]=Te(I),w[P].c(),w[P].m(f,A))}for(;P<w.length;P+=1)w[P].d(1);w.length=W.length}if(O&223){q=ee(pe);let P;for(P=0;P<q.length;P+=1){const I=Le(p,q,P);M[P]?M[P].p(I,O):(M[P]=Se(I),M[P].c(),M[P].m(u,k))}for(;P<M.length;P+=1)M[P].d(1);M.length=q.length}if(O&0){Q=ee(te);let P;for(P=0;P<Q.length;P+=1){const I=Oe(p,Q,P);_[P]?_[P].p(I,O):(_[P]=Ne(I),_[P].c(),_[P].m(F,D))}for(;P<_.length;P+=1)_[P].d(1);_.length=Q.length}j!==(j=U(p))&&(H.d(1),H=j(p),H&&(H.c(),H.m(L.parentNode,L)))},i:Ce,o:Ce,d(p){p&&(m(s),m(c),m(u),m(v),m(L)),fe(w,p),fe(M,p),fe(_,p),H.d(p)}}}const lt=3,te="ABCDEFGH",pe="87654321";function ct(o,s,l){const c=new et.Game;var u=!1,f=["",""],g="♜♞♝♛♚♝♞♜|♟♟♟♟♟♟♟♟♟|        |        |        |        |♟♟♟♟♟♟♟♟♟|♜♞♝♛♚♝♞♜".split("|").map(v=>v.split("")),d="bbbbbbbb|bbbbbbbb|nnnnnnnn|nnnnnnnn|nnnnnnnn|nnnnnnnn|wwwwwwww|wwwwwwww".split("|").map(v=>v.split("")),A=[],B={halfMove:1,castling:{}},y=["",0,0];const k=(v,L,W,w)=>{y=[w+W,v,L],l(4,A=c.moves(y[0]))},F=(v,L,W,w)=>{var q=[g[y[1]][y[2]],d[y[1]][y[2]]];g[v][L],d[v][L],l(2,g[y[1]][y[2]]=" ",g),l(3,d[y[1]][y[2]]="n",d),l(2,g[v][L]=q[0],g),l(3,d[v][L]=q[1],d),q[0]=="♚"&&(v==7||v==0)&&(B.castling.whiteShort&&L==6&&(l(2,g[v][7]=" ",g),l(3,d[v][7]="n",d),l(2,g[v][5]="♜",g),l(3,d[v][5]="w",d)),B.castling.whiteLong&&L==2&&(l(2,g[v][0]=" ",g),l(3,d[v][0]="n",d),l(2,g[v][3]="♜",g),l(3,d[v][3]="w",d))),!u&&q[0]=="♟"&&L==0&&l(2,g[L][v]="♛",g),c.move(y[0],w+W),l(0,u=!0),setTimeout(()=>{var M=B.castling.blackShort,Q=B.castling.blackLong;if(!c.exportJson().isFinished){l(1,f=Object.entries(c.aiMove(lt))[0]);var _=te.indexOf(f[0][0]),U=pe.indexOf(f[0][1]),j=te.indexOf(f[1][0]),H=pe.indexOf(f[1][1]),p=[g[U][_],d[U][_]];g[H][j],d[H][j],p[0]=="♚"&&(H==7||H==0)&&(M&&j==6&&(l(2,g[H][7]=" ",g),l(3,d[H][7]="n",d),l(2,g[H][5]="♜",g),l(3,d[H][5]="b",d)),Q&&j==2&&(l(2,g[H][0]=" ",g),l(3,d[H][0]="n",d),l(2,g[H][3]="♜",g),l(3,d[H][3]="b",d))),l(2,g[U][_]=" ",g),l(3,d[U][_]="n",d),l(2,g[H][j]=p[0],g),l(3,d[H][j]=p[1],d),u&&p[0]=="♟"&&H==7&&l(2,g[H][j]="♛",g),l(0,u=!1)}l(5,B=c.exportJson())},500)};return[u,f,g,d,A,B,k,F,(v,L,W,w)=>k(v,L,W,w),()=>l(4,A=[]),(v,L,W)=>!u&&A.includes(v+L)?(W.preventDefault(),!0):!1,(v,L,W,w)=>F(v,L,W,w)]}class ut extends Ve{constructor(s){super(),Ye(this,s,ct,rt,Je,{})}}export{ut as component};
